# -*- coding: utf-8 -*-

"""
Created on Thu Nov 26 10:20:04 2015
@author: salimeh
"""

"""
Created on Thu Nov 26 10:20:04 2015
@author: salimeh
"""

import io
import tempfile
import datetime
import os
import pandas
from pprint import pprint

from dlstats.fetchers._commons import Datasets
from dlstats.fetchers import esri
from dlstats import constants

import unittest
from unittest import mock

from dlstats.tests.base import RESOURCES_DIR, BaseTestCase, BaseDBTestCase

dataset_names = ['esri_gaku-jk1522', 'esri_gaku-jfy1522', 'esri_gaku-jg1522', 'esri_gaku-mcy1522',
                 'esri_gaku-mk1522', 'esri_gaku-mfy1522', 'esri_gaku-mg1522', 'esri_gaku-jcy1522',
                 'esri_def-qg1522', 'esri_def-qk1522', 'esri_def-fy1522', 'esri_def-cy1522']

DATASETS = {d:{} for d in dataset_names}

DATASETS['esri_gaku-jk1522']["data"] ="""名目原系列,,,,,,,,,,,,,,,<参考>,,,,,,,,,,,,,,(単位:10億円),,,
Nominal Gross Domestic Product (original series),,,,,,,,,,,,,,,<cf>,,,,,,,,,,,,,,(Billion Yen),,,
,国内総生産(支出側),民間最終消費支出,,,民間住宅,民間企業設備,民間在庫品増加,政府最終消費支出,公的固定資本形成,公的在庫品増加,財貨・サービス,,,,海外からの所得,,,国民総所得,,国内需要,民間需要,公的需要,,総固定資本形成,,国内総生産(支出側)(除FISIM）,家計最終消費支出（除FISIM）,財貨・サービス,,,,
,,,家計最終消費支出,,,,,,,,純輸出,輸出,輸入,,純受取,受取,支払,,,,,,,,,,,輸出,輸入,,,
,,,,除く持ち家の帰属家賃,,,,,,,,,,,,,,,,,,,,,,,,（除FISIM）,（除FISIM）,,,
,GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,Residual,,TradingGains/Losses,GDI,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
,,,,,,,,,,,Net Exports,Exports,Imports,,,,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/ 1- 3.,"447,210.5 ","257,603.0 ","253,151.9 ","217,329.3 ","22,996.1 ","58,663.9 ","3,068.1 ","68,734.1 ","40,134.2 ","-1,114.6 ",223.9 ,"39,120.9 ","38,897.0 ","-3,098.3 ",,"11,273.9 ","458,484.3 ","3,856.4 ","15,043.0 ","11,186.6 ","462,340.7 ",,"450,620.2 ","342,425.3 ","108,185.4 ",,"120,617.4 ",,"440,388.8 ","247,669.3 ","38,768.3 ","38,586.1 "
4- 6.,"442,412.1 ","257,415.7 ","252,946.4 ","216,937.5 ","24,151.6 ","58,136.5 ","-3,321.3 ","69,847.4 ","41,222.7 ",343.2 ,-251.0 ,"39,280.6 ","39,531.6 ","-5,132.7 ",,"10,223.0 ","452,635.1 ","3,649.7 ","15,061.1 ","11,411.4 ","456,284.8 ",,"446,029.8 ","335,152.9 ","110,969.4 ",,"122,108.3 ",,"435,588.4 ","247,465.6 ","38,923.0 ","39,297.7 "
7- 9.,"451,090.3 ","262,336.9 ","257,850.4 ","221,581.3 ","26,386.5 ","57,966.1 ",-604.5 ,"70,272.6 ","39,702.2 ",220.2 ,-392.1 ,"40,054.7 ","40,446.8 ","-4,797.6 ",,"9,486.3 ","460,576.6 ","3,376.1 ","15,254.1 ","11,878.0 ","463,952.6 ",,"454,887.7 ","345,100.6 ","109,793.6 ",,"122,509.8 ",,"444,165.6 ","252,291.5 ","39,695.6 ","40,215.8 "
10-12.,"446,326.0 ","259,884.5 ","255,368.2 ","218,953.1 ","25,165.9 ","58,767.4 ","-1,743.7 ","70,338.3 ","38,928.6 ",266.5 ,-674.0 ,"40,218.9 ","40,892.9 ","-4,607.5 ",,"9,603.8 ","455,929.7 ","3,748.6 ","15,997.2 ","12,248.6 ","459,678.4 ",,"450,175.3 ","341,104.1 ","109,089.9 ",,"121,545.9 ",,"439,381.2 ","249,800.9 ","39,861.3 ","40,665.9 "
"""

DATASETS["series_names"] = ['GDP (Expenditure Approach)', 'Private Consumption' ,'Consumption of Households' ,'Excluding Imputed Rent' ,
                            'Private Residential Investment' ,'Private Non-Resi.Investment' ,'Change in Private Inventories',
                            'Government Consumption' ,'Public Investment', 'Change in Public Inventories', 'Goods & Services, Net Exports',
                            'Goods & Services, Exports', 'Goods & Services, Imports','Residual','nan','Trading Gains/Losses', 'GDI',
                            'Income from/to the Rest of the World, Net','Income from/to the Rest of the World, Receipt',
                            'Income from/to the Rest of the World, Payment','GNI', 'nan',
                            'Domestic Demand','Private Demand', 'Public Demand','nan','Gross Fixed Capital Formation','nan',
                            'GDP, Excluding FISIM', 'Consumption of Households, Excluding FISIM', 'Export, Excluding FISIM' , 'Import, Excluding FISIM']

DATASETS['esri_gaku-jfy1522']["data"]=""",GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,Residual,,TradingGains/Losses,GDI,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
Fiscal Year,,,,,,,,,,,Net Exports,Exports,Imports,,,,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/4-3.,"447,167.4 ","259,853.9 ","255,336.4 ","219,013.7 ","25,022.9 ","58,499.9 ",-878.4 ,"70,601.5 ","39,088.0 ",-33.9 ,-647.3 ,"40,052.6 ","40,699.9 ","-4,339.3 ",,"9,728.6 ","456,895.9 ","3,607.9 ","15,620.9 ","12,013.0 ","460,503.8 ",,"451,058.7 ","341,681.2 ","109,394.9 ",,"121,275.6 ",,"440,217.2 ","249,780.6 ","39,694.3 ","40,470.8 "
"""

DATASETS['esri_gaku-jg1522']["data"]=""",GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,Residual,,TradingGains/Losses,GDI,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
,,,,,,,,,,,Net Exports,Exports,Imports,,,,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/ 1- 3.,"109,177.4 ","63,301.3 ","62,683.8 ","53,738.5 ","5,538.3 ","15,896.0 ","-2,398.7 ","17,566.9 ","10,634.7 ",-201.9 ,55.6 ,"9,653.5 ","9,597.9 ","-1,214.8 ",,"2,718.3 ","111,895.7 ","1,066.5 ","4,198.3 ","3,131.7 ","112,962.2 ",,"109,984.9 ","81,959.8 ","28,065.6 ",,"31,837.8 ",,"107,489.2 ","61,316.0 ","9,565.4 ","9,519.6 "
4- 6.,"107,400.2 ","62,428.0 ","61,210.4 ","52,236.6 ","5,837.6 ","13,795.9 ",563.8 ,"17,571.2 ","8,293.8 ",66.0 ,-171.6 ,"9,615.5 ","9,787.2 ",-984.5 ,,"2,517.3 ","109,917.6 ","1,058.8 ","3,674.3 ","2,615.6 ","110,976.3 ",,"108,349.1 ","82,543.6 ","25,796.6 ",,"27,681.7 ",,"105,710.1 ","59,849.9 ","9,526.3 ","9,728.3 "
7- 9.,"112,620.8 ","66,359.6 ","65,142.8 ","56,065.4 ","6,888.2 ","14,836.5 ",-542.4 ,"17,223.5 ","9,194.1 ",35.6 ,-163.8 ,"10,025.2 ","10,189.1 ","-1,210.4 ",,"2,455.4 ","115,076.2 ",760.0 ,"3,857.0 ","3,097.1 ","115,836.2 ",,"113,616.2 ","87,231.9 ","26,357.0 ",,"30,572.6 ",,"110,889.3 ","63,749.7 ","9,935.4 ","10,131.7 "
10-12.,"117,581.5 ","67,263.6 ","65,823.1 ","56,690.0 ","6,449.3 ","13,838.0 ","1,766.6 ","17,461.0 ","11,749.1 ",24.7 ,21.2 ,"10,389.0 ","10,367.7 ",-992.0 ,,"2,450.9 ","120,032.4 ",764.8 ,"3,583.3 ","2,818.5 ","120,797.1 ",,"118,483.9 ","89,315.2 ","29,185.2 ",,"31,499.5 ",,"115,811.9 ","64,421.7 ","10,299.3 ","10,311.7 "
"""

DATASETS['esri_gaku-mcy1522']["data"] = """,GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
Calendar Year,,,,,,,,,,,Net Exports,Exports,Imports,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/1-12.,"495,743.4","273,994.8","269,297.8","234,248.9","25,504.6","71,596.3","-1,272.3","72,842.0","42,856.0",360.3,"9,861.7","44,627.3","34,765.7",,"3,937.2","16,502.9","12,565.6","499,680.6",,"485,881.7","369,823.3","116,058.4",,"139,956.9",,"490,647.6","264,726.7","44,269.7","34,386.7"
"""

DATASETS['esri_gaku-mk1522']["data"] = """,GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,,
Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
,,,,,,,,,,,Net Exports,Exports,Imports,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/ 1- 3.,"495,035.9 ","271,377.1 ","266,763.2 ","232,317.4 ","23,748.1 ","72,524.2 ","2,041.2 ","71,122.9 ","43,217.9 ",-445.9 ,"11,450.4 ","44,573.5 ","33,123.1 ",,"4,172.3 ","16,218.8 ","12,046.5 ","499,208.2 ",,"483,585.5 ","369,690.6 ","113,894.9 ",,"139,490.2 ",,"490,161.3 ","262,577.4 ","44,121.7 ","32,846.3 "
4- 6.,"492,513.0 ","272,336.9 ","267,672.8 ","232,855.0 ","24,954.5 ","71,487.9 ","-3,961.8 ","72,654.6 ","44,461.0 ",529.1 ,"10,050.8 ","44,742.9 ","34,692.1 ",,"3,974.0 ","16,243.9 ","12,269.9 ","496,487.0 ",,"482,462.2 ","364,817.5 ","117,644.7 ",,"140,903.4 ",,"487,525.8 ","263,134.0 ","44,416.6 ","34,279.0 "
7- 9.,"500,170.8 ","277,198.7 ","272,503.3 ","237,278.2 ","27,249.5 ","70,906.3 ",-942.2 ,"73,404.9 ","42,655.4 ",650.3 ,"9,047.9 ","44,569.6 ","35,521.7 ",,"3,594.5 ","16,402.6 ","12,808.1 ","503,765.3 ",,"491,123.0 ","374,412.4 ","116,710.6 ",,"140,811.2 ",,"494,978.0 ","267,777.6 ","44,243.4 ","35,108.7 "
10-12.,"495,280.7 ","274,935.5 ","270,197.4 ","234,491.1 ","25,909.2 ","71,478.0 ","-2,371.1 ","74,088.1 ","41,684.8 ",713.8 ,"8,842.2 ","44,579.5 ","35,737.3 ",,"4,039.4 ","17,246.3 ","13,206.9 ","499,320.0 ",,"486,438.5 ","369,951.7 ","116,486.8 ",,"139,072.0 ",,"489,952.2 ","265,363.4 ","44,253.2 ","35,324.2 "
"""

DATASETS['esri_gaku-mfy1522']["data"] = """,GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
Fiscal Year,,,,,,,,,,,Net Exports,Exports,Imports,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/4-3.,"495,612.2 ","274,709.2 ","269,986.9 ","234,530.8 ","25,803.9 ","71,387.4 ","-1,457.4 ","73,778.0 ","41,947.4 ",424.1 ,"9,019.7 ","44,610.1 ","35,590.5 ",,"3,892.7 ","16,832.6 ","12,939.8 ","499,504.9 ",,"486,592.5 ","370,443.1 ","116,149.5 ",,"139,138.7 ",,"490,384.5 ","265,250.9 ","44,283.9 ","35,177.4 "
"""
DATASETS['esri_gaku-mg1522']["data"] = """,GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
,,,,,,,,,,,Net Exports,Exports,Imports,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/ 1- 3.,"119,879.2 ","66,316.0 ","65,711.1 ","57,112.6 ","5,710.0 ","19,654.6 ","-2,954.1 ","17,022.5 ","11,442.3 ",-113.5 ,"2,801.6 ","11,122.8 ","8,321.2 ",,"1,135.3 ","4,469.0 ","3,333.7 ","121,014.5 ",,"117,077.6 ","88,726.4 ","28,351.2 ",,"36,806.8 ",,"118,660.5 ","64,664.7 ","11,009.8 ","8,252.0 "
4- 6.,"120,882.8 ","66,235.3 ","64,950.3 ","56,248.9 ","6,034.3 ","16,982.4 ",729.9 ,"19,616.3 ","8,914.9 ",32.6 ,"2,337.1 ","10,834.4 ","8,497.3 ",,"1,158.4 ","4,020.1 ","2,861.7 ","122,041.2 ",,"118,545.7 ","89,981.9 ","28,563.8 ",,"31,931.5 ",,"119,636.0 ","63,815.6 ","10,752.8 ","8,394.0 "
7- 9.,"122,430.1 ","69,862.5 ","68,710.3 ","59,895.9 ","7,096.8 ","18,115.9 ",-782.6 ,"15,892.3 ","9,867.9 ",113.6 ,"2,263.5 ","11,115.0 ","8,851.5 ",,803.8 ,"4,079.4 ","3,275.6 ","123,233.9 ",,"120,166.6 ","94,292.7 ","25,873.8 ",,"35,080.7 ",,"121,131.8 ","67,528.8 ","11,033.4 ","8,748.2 "
10-12.,"132,551.4 ","71,581.0 ","69,926.2 ","60,991.5 ","6,663.5 ","16,843.4 ","1,734.4 ","20,310.9 ","12,631.0 ",327.6 ,"2,459.5 ","11,555.3 ","9,095.8 ",,839.7 ,"3,934.3 ","3,094.6 ","133,391.1 ",,"130,091.9 ","96,822.4 ","33,269.5 ",,"36,137.9 ",,"131,219.3 ","68,717.7 ","11,473.7 ","8,992.5 "
"""

DATASETS['esri_gaku-jcy1522']["data"]=""",GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,Residual,,TradingGains/Losses,GDI,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
Calendar Year,,,,,,,,,,,Net Exports,Exports,Imports,,,,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/1-12.,"446,779.9","259,352.5","254,860.1","218,730.5","24,713.3","58,366.4",-610.6,"69,822.6","39,871.7",-75.6,-258.7,"39,683.2","39,941.9","-4,401.7 ",,"10,141.9","456,921.8","3,650.1","15,312.9","11,662.8","460,571.9",,"450,434.1","341,050.5","109,404.4",,"121,591.6",,"439,900.4","249,337.2","39,326.4","39,691.3"
"""

DATASETS['esri_def-qg1522']["data"]=""",GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
,,,,,,,,,,,Net Exports,Exports,Imports,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/ 1- 3.,109.8 ,104.8 ,104.8 ,106.3 ,103.1 ,123.6 ,***,96.9 ,107.6 ,***,***,115.2 ,86.7 ,,***,106.4 ,106.4 ,107.1 ,,106.4 ,108.3 ,101.0 ,,115.6 ,,110.4 ,105.5 ,115.1 ,86.7 
4- 6.,112.6 ,106.1 ,106.1 ,107.7 ,103.4 ,123.1 ,***,111.6 ,107.5 ,***,***,112.7 ,86.8 ,,***,109.4 ,109.4 ,110.0 ,,109.4 ,109.0 ,110.7 ,,115.4 ,,113.2 ,106.6 ,112.9 ,86.3 
7- 9.,108.7 ,105.3 ,105.5 ,106.8 ,103.0 ,122.1 ,***,92.3 ,107.3 ,***,***,110.9 ,86.9 ,,***,105.8 ,105.8 ,106.4 ,,105.8 ,108.1 ,98.2 ,,114.7 ,,109.2 ,105.9 ,111.1 ,86.3 
10-12.,112.7 ,106.4 ,106.2 ,107.6 ,103.3 ,121.7 ,***,116.3 ,107.5 ,***,***,111.2 ,87.7 ,,***,109.8 ,109.8 ,110.4 ,,109.8 ,108.4 ,114.0 ,,114.7 ,,113.3 ,106.7 ,111.4 ,87.2 
"""

DATASETS['esri_def-qk1522']["data"]=""",GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
,,,,,,,,,,,Net Exports,Exports,Imports,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/ 1- 3.,110.7 ,105.3 ,105.4 ,106.9 ,103.3 ,123.6 ,***,103.5 ,107.7 ,***,***,113.9 ,85.2 ,,***,107.8 ,107.7 ,108.0 ,,107.3 ,108.0 ,105.3 ,,115.6 ,,111.3 ,106.0 ,113.8 ,85.1 
4- 6.,111.3 ,105.8 ,105.8 ,107.3 ,103.3 ,123.0 ,***,104.0 ,107.9 ,***,***,113.9 ,87.8 ,,***,107.9 ,107.5 ,108.8 ,,108.2 ,108.9 ,106.0 ,,115.4 ,,111.9 ,106.3 ,114.1 ,87.2 
7- 9.,110.9 ,105.7 ,105.7 ,107.1 ,103.3 ,122.3 ,***,104.5 ,107.4 ,***,***,111.3 ,87.8 ,,***,107.5 ,107.8 ,108.6 ,,108.0 ,108.5 ,106.3 ,,114.9 ,,111.4 ,106.1 ,111.5 ,87.3 
10-12.,111.0 ,105.8 ,105.8 ,107.1 ,103.0 ,121.6 ,***,105.3 ,107.1 ,***,***,110.8 ,87.4 ,,***,107.8 ,107.8 ,108.6 ,,108.1 ,108.5 ,106.8 ,,114.4 ,,111.5 ,106.2 ,111.0 ,86.9 
"""

DATASETS['esri_def-fy1522']["data"]=""",GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
Fiscal Year,,,,,,,,,,,Net Exports,Exports,Imports,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/4-3.,110.8 ,105.7 ,105.7 ,107.1 ,103.1 ,122.0 ,***,104.5 ,107.3 ,***,***,111.4 ,87.4 ,,***,107.8 ,107.7 ,108.5 ,,107.9 ,108.4 ,106.2 ,,114.7 ,,111.4 ,106.2 ,111.6 ,86.9 
"""
DATASETS['esri_def-cy1522']["data"]=""",GDP(Expenditure Approach),PrivateConsumption,Consumption ofHouseholds,ExcludingImputed Rent,PrivateResidentialInvestment,Private Non-Resi.Investment,Changein PrivateInventories,GovernmentConsumption,PublicInvestment,Changein PublicInventories,Goods & Services,,,,Income from /to the Rest of the World,,,GNI,,DomesticDemand,PrivateDemand,PublicDemand,,Gross Fixed CapitalFormation,,GDP,Consumption ofHouseholds,Export,Import
Calendar Year,,,,,,,,,,,Net Exports,Exports,Imports,,Net,Receipt,Payment,,,,,,,,,Excluding FISIM,,,
1994/1-12.,111.0 ,105.6 ,105.7 ,107.1 ,103.2 ,122.7 ,129.0 ,104.3 ,107.5 ,42.0 ,***,112.5 ,87.0 ,,***,107.8 ,107.7 ,108.5 ,,107.9 ,108.4 ,106.1 ,,115.1 ,,111.5 ,106.2 ,112.6 ,86.6 
"""

def get_csv_data(self,code,**kwargs):
    return pandas.read_csv(io.StringIO(DATASETS[code]['data']),**kwargs)

def fake_release_date(arg):
    return datetime.datetime(1900,1,1)

class FakeDataset():
    def __init__(self,code):
        self.provider_name = 'Esri'
        self.dataset_code = code
        self.dimension_list = []
        self.attribute_list = []
        
@mock.patch('dlstats.fetchers.esri.EsriData.get_csv_data',get_csv_data)
@mock.patch('dlstats.fetchers.esri.EsriData.get_release_date',fake_release_date)
class EsriFixSeriesTestCase(BaseTestCase):
    """ESRI fixing series names
    """

    # nosetests -s -v dlstats.tests.fetchers.test_esri:EsriFixSeriesTestCase

    def test_fix_series_name(self):

        # nosetests -s -v dlstats.tests.fetchers.test_esri:EsriFixSeriesTestCase.test_fix_series_name

        for d in dataset_names:
            dataset = FakeDataset(d)
            e = esri.EsriData(dataset,d)

            variable_names = e.fix_series_names()

            self.assertEqual(list(variable_names),DATASETS['series_names'])
            # TODO remove when DATASETS are completed
            break